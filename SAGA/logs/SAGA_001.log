 
PREPARE_CAST:  load raw data and store into MAT files
    Found previously prepared CTD-PROFILE data.
    Found previously prepared CTD-TIME data.
    Found previously prepared NAV data.
 
RDILOAD:  load ADCP data
    Loading down-data data/raw_ladcp/001/001DN000.000
    Detected BB or WH data
    blank length downlooker: 1.76 m
    Read 14539 ensembles with 12 bins each
    Loading up-data data/raw_ladcp/001/001UP000.000
>   Found 12 ensembles with NaN as time 
>     removing those and continuing with the rest
    blank length uplooker: 1.76 m
    Read 14427 ensembles with 25 bins each
>   data at beginning of downlooker is missing
>   padding data set
    Shifting ADCP timeseries by 130 ensembles
    Time-lag: 130 time steps    Correlation : 0.99864
    Number of joint ensembles is : 14427
    Down looking instrument ID : 16386
    Up looking instrument ID   : 16387
    Found 56 finite RDI bottom velocities
    Detected  7 %  3 BEAM solutions up-looking
    Detected  5 %  3 BEAM solutions down-looking
    Removed 2588 values because of high error velocity
    Removed 8 bottom values because of high error velocity
 
LOADING:  load the prepared MAT files
    NAV    : loading NAV time series data/nav/nav001.mat
      Number of NAV lines     : 11090
      Data rate               : 0.95041 seconds
    CTDTIME: loading CTD-time series data/ctdtime/ctdtime001.mat
      Number of CTD-time lines: 11090
      Data rate               : 0.95041 seconds
    CTD    : loading CTD profile data data/ctdprof/ctdprof001.mat
      Number of CTD-prof lines: 5371
    SADCP  : loading SADCP profile data data/sadcp/sadcp001.mat
>   Can not find data/sadcp/sadcp001.mat
 
MERGEDATA:  merge ADCP, navigational, and CTD-time data
    ADCP data coverage:
      2021-03-12 21:53:55  to  2021-03-13 02:03:56
    Navigation data coverage:
      2021-03-12 21:57:41  to  2021-03-13 01:51:59
>   Found 907 LADCP data outside navigational data coverage
>   There might be a problem with your navigational data extraction
>     Will continue anyway.
>   Replacing missing values by nearest nav value
    CTD data coverage:
      2021-03-12 21:57:41  to  2021-03-13 01:51:59
 
    CTD max depth : 5262
    chunkwise acceleration lag: 6  correlation: 0.12856
    all data lag              : -3  correlation: 0.69402
    all data integral lag     : 150  correlation: 0.99108
    median lag -1
    most popular lag -2
    best correlated lag 150
    CALC_ADCP_CTD_LAG :  best lag is: 150  for which 4% of 23 lag calculations agree
    Best W lag at: 150 CTD scans ~-148 seconds  corr:0.99108
    Adjusting CTD time to ADCP time and shift depth record 
 
IMPROVE:  apply various improvements to the data
    Outlier discarded 6195 bins down looking
    Outlier discarded 20 bottom track
    Outlier discarded 13197 bins up looking
    Applying magnetic deviation of: -8.4816
    Removing 3745 values because of vertical speed deviates > 0.2 m/s
    Removing 1283 values because of horizontal speed > 2.5 m/s
    Removing 0 profiles due to tilt larger than 22
    Removing 88 profiles due to tilt difference larger than 4
 
GETBTRACK:  create own bottom track data in addition to RDI
    in: p.btrk_mode 3 and p.btrk_used 1
    Found 43 RDI bottom track values 
    Using high bottom echo amplitudes to create bottom track
    localmax2: found 2723 valid values
    Using 0.5 bins below maximum target strength for own bottom track velocity
    Created 2 bottom distances keeping original
    Removed 1 bottom track profiles W_btrk - W_ref difference > 0.05
    Boutlier removed 0 bottom track velocities 
    Created 1 bottom track velocities keeping original
    out: p.btrk_mode 3 and p.btrk_used 1
 
CALC_DEPTH:  determine the depth of the LADCP during cast
    Calculating simple LADCP depth from w
    Maximum depth from int W is : 5262
    Preset maximum depth is     : NaN
    Not enough data to determine water depth.
    Found bottom at NaN +/- NaN m
    Using CTD pressure record for depth
    LADCP minus CTD depth mean: 191.7908  std: 125.8419
 
CALC_SOUNDSP:  calculate sound speed profile and correct the raw data
    Calculating soundspeed from CTD profile 
    Correcting all ADCP velocities for sound speed 
 
CALC_DEPTH:  determine the depth of the LADCP during cast
    Calculating simple LADCP depth from w
    Maximum depth from int W is : 5262
    Preset maximum depth is     : NaN
    Not determining water depth. (no data or turned off)
    Found bottom at NaN +/- NaN m
    Using CTD pressure record for depth
    LADCP minus CTD depth mean: 197.9556  std: 124.9528
 
MISC_CUT_PROFILE:  cut raw LADCP data to only the profile part
    Removing 4070 values below bottom or above surface
    Removing data at beginning and end of cast
      adjusting start and end time 
 
EDIT_DATA:  apply various editing algorithms to velocities
    Side-lobe contamination   : set 570 weights to NaN
    Spike filter              : set 4866 weights to NaN
 
PREPINV:  prepare data for inversion
    Reducing weights for tilts larger than 10 degree
    Mean heading offset based on compass is -90.9774 deg
    Mean heading offset based on tilt is -92.7701 deg
    Rot up2down is using average up/down compass
 
CALC_ENS_AV: forming Super-Ensembles
    Averaging profiles over (p.avdz) 8 m
    Removing reference velocity and average ensembles 
    Outlier discarded 540 bins down looking
    Outlier discarded 1313 bins up looking
    Setting 205 weight values to NaN  because super ensemble std=0 
    Setting 132 values to minimum super ensemble std 0.025106
    Reduced ensemble size is 1105
 
LANARROW:  remove outliers in superensembles
 
GETINV:  compute optimal velocity profile
    Barotropic (navigation) velocity error : 0.0044151 [m/s]
    Super ensemble velocity error : 0.0098195 [m/s]
    Vertical resolution (ps.dz) is 8 [m]
    Using super ensemble std based weights normalized by 0.02 m/s (figure 16 lower graph)
    Preaveraged GPS ship vel 0 times 
    Removed 595 constraints below minimum weight 
    Smoothing Ocean velocity profile
    Found 8 ill constrained elements will smooth 
    Smoothing CTD velocity profile
    Found 1 ill constrained elements will smooth 
    No bottom track data
    No SADCP data
    lainbaro: 7% of profile have no useful data 
    Normalized barotropic constraint weight: 2.6626
    Mean individual ctd velocity weight : 242.6957
    ready for inversion  length of  d:  25037
              (CTD vel)  length of A1:   1105
            (ocean vel)  length of A2:    668
  Cholesky transform
    Sorry dz not constant, looping over 24579 elements
    Giving low weight to the 1% of data scans deviating most
 
PREPINV:  prepare data for inversion
    Mean heading offset based on compass is -90.9774 deg
    Mean heading offset based on tilt is -92.7701 deg
    Removing first guess ocean velocity from raw data
    Adjusted for velocity offset in up and down looking ADCP
    Removing first guess ocean velocity from raw data
    Rot up2down is using average up/down compass
    Rotated earlier, using only difference 
 
CALC_ENS_AV: forming Super-Ensembles
    Averaging profiles over (p.avdz) 8 m
    Removing reference velocity and average ensembles 
    Outlier discarded 505 bins down looking
    Outlier discarded 1288 bins up looking
    Setting 227 weight values to NaN  because super ensemble std=0 
    Setting 120 values to minimum super ensemble std 0.025106
    Reduced ensemble size is 1105
 
GETINV:  compute optimal velocity profile
    Barotropic (navigation) velocity error : 0.0044151 [m/s]
    Super ensemble velocity error : 0.0098826 [m/s]
    Setting velocity error to :0.025597 [m/s]
    RDI standard deviation (down,up) :0.0078878      0.0173 [m/s]
    Vertical resolution (ps.dz) is 8 [m]
    Using super ensemble std based weights normalized by 0.025597 m/s (figure 16 lower graph)
    Preaveraged GPS ship vel 0 times 
    Removed 590 constraints below minimum weight 
    Smoothing Ocean velocity profile
    Found 7 ill constrained elements will smooth 
    Smoothing CTD velocity profile
    Found 1 ill constrained elements will smooth 
    No bottom track data
    No SADCP data
    lainbaro: 7% of profile have no useful data 
    Normalized barotropic constraint weight: 3.4078
    Mean individual ctd velocity weight : 358.4477
    ready for inversion  length of  d:  25080
              (CTD vel)  length of A1:   1105
            (ocean vel)  length of A2:    668
  Moore-Penrose inverse
    Sorry dz not constant, looping over 24639 elements
    Solving only down trace
    Smoothing Ocean velocity profile
    Found 5 ill constrained elements will smooth 
    Smoothing CTD velocity profile
    Found 1 ill constrained elements will smooth 
  Cholesky transform
    Solving only up trace
    Smoothing Ocean velocity profile
    Found 8 ill constrained elements will smooth 
    Smoothing CTD velocity profile
    Found 1 ill constrained elements will smooth 
  Cholesky transform
 
CHECKINV:  displaying check values 
    The following values are given in [m/s] 
    Velocity profile error:  0.024  should be about noise:  0.020
    GPS-LADCP ship spd diff: 0.001  should be smaller than  0.004 /  1.000
 
CHECKBTRK:  check bottom track against U_ctd solution 
 
CALC_SHEAR3:  calculate a baroclinic velocity profile based on shears only
    Averaging shear profile over (ps.dz) 8 [m]
    Maximum allowed std within calculation intervals : 2
    Data deviating more from the median will be discarded.
 
CHECK_BATTERY:  display the battery voltage
>   Do not have calibration coefficient for this instrument.
>     To get battery information in the future, please measure the
>     battery voltage after the cast and divide it by
>     93.8001
>     Then enter the line:
>     12542746133   Your-Serialnumber   Your-Value
>     in the file  m/batt_info.dat  .
>     You can also send the info to gkrahmann@ifm-geomar.de
>     so that it will be included in future software updates.
>   Battery voltage is unknown. Need calibration coeff.
 
LADCP WARNINGS                                         
>   Found LARGE timing difference between ADCPs !      
>   Battery voltage is unknown. Need calibration coeff.
 
LADCP processing warnings: 
 
SAVING RESULTS
save profiles/SAGA_001.mat ts dr p ps f -v6;
 
    Writing processing protocol profiles/SAGA_001.txt
 
    Processing took 185 seconds
process_cast(2)
GEOMAR LADCP software: Version 10.22: 2017-02-10
